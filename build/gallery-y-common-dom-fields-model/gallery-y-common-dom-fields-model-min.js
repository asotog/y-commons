YUI.add("gallery-y-common-dom-fields-model",function(e,t){e.namespace("Common"),e.Common.DomFieldsModel=e.Base.create("gallery-y-common-dom-fields-model",e.Base,[],{initializer:function(){var e=this},save:function(){this.get("configuration")?this._saveUsingConfiguration():this._save()},_save:function(){var e=[];this.get("container").all(this.get("formFieldsSelector")).each(function(t){var n={};n.node=t,t.get("type")=="radio"||t.get("type")=="checkbox"?n.value=t.get("checked"):n.value=t.get("value"),e.push(n)}),this.set("model",e)},_saveUsingConfiguration:function(){var t=this,n={};e.Array.each(this.get("configuration"),function(r){r.type==e.Common.DomFieldsModel.LIST?n=t._saveList(r,n):n[r.name]=t._retrieveFieldVal(t.get("container").one(t._getFieldSelector(r)),r)}),this.set("model",n)},load:function(){this.get("model")&&(this.get("configuration")?this._loadUsingConfiguration():this._load())},_load:function(){e.Array.each(this.get("model"),function(e){e.node.get("type")=="radio"&&e.value?e.node.simulate("click"):e.node.get("type")=="checkbox"?e.node.set("checked",e.value):e.node.set("value",e.value),e.node.simulate("change")})},_loadUsingConfiguration:function(){var t=this;e.Array.each(this.get("configuration"),function(n){n.type!=e.Common.DomFieldsModel.STATIC&&n.type!=e.Common.DomFieldsModel.LIST&&t._loadField(t.get("model")[n.name],n,t.get("container"))})},_loadField:function(t,n,r){n.type!=e.Common.DomFieldsModel.RADIO&&r.one(n.fieldSelector).set("value",t)},_saveList:function(t,n){var r=this;return n[t.name]=[],this.get("container").all(t.container).each(function(i){var s={};e.Array.each(t.fields,function(e){s[e.name]=r._retrieveFieldVal(i.one(r._getFieldSelector(e)),e)}),n[t.name].push(s)}),n},_retrieveFieldVal:function(t,n){var r=n.type==e.Common.DomFieldsModel.STATIC?"innerHTML":"value",i=t?t.get(r):null;return e.Lang.trim(i)==""?null:i},_getFieldSelector:function(t){return t.type==e.Common.DomFieldsModel.RADIO?t.fieldSelector+":checked":t.fieldSelector},destructor:function(){}},{ATTRS:{container:{value:null},configuration:{value:null},model:{value:null},formFieldsSelector:{value:'input[type="text"],input[type="hidden"],input[type="radio"],input[type="checkbox"],select'}}}),e.Common.DomFieldsModel.statics={LIST:"list",STATIC:"static",RADIO:"radio"}},"@VERSION@",{requires:["yui-base","base-build","node","node-event-simulate"]});
